- Android 平台利用基于用户的 Linux 保护机制识别和隔离应用资源，为此，Android 会为每个 Android 应用分配一个独一无二的用户 ID (UID)，并在自己的进程中运行。Android 会使用此 UID 设置一个内核级应用沙盒。
- 这一沙盒机制非常简单，可审核，并且基于已有数十年历史的 UNIX 风格的进程用户隔离和文件权限机制。
- **保护**
- Android 依靠许多保护机制来强制执行应用沙盒。这些强制措施是随着时间的推移不断引入的，并且显著增强了基于 UID 的原始自主访问控制 ([[DAC]]) 沙盒的安全性。以前的 Android 版本包括以下保护机制：
	- 在 [[Android 5]].0 中，[[SELinux]] 提供了强制访问控制 ([[MAC]]) 来将系统和应用分离开。但是，所有第三方应用都在相同的 SELinux 环境中运行，因此应用间的隔离主要由 UID DAC 强制执行。
	- 在 [[Android 6]].0 中，SELinux 沙盒经过扩展，可以跨各个物理用户边界隔离应用。此外，Android 还为应用数据设置了更安全的默认设置：对于 [[targetSdkVersion]] >= 24 的应用，应用主目录上的默认 DAC 权限从 751 更改为 700。这为私有应用数据提供了更安全的默认设置（但应用可能会替换这些默认设置）。
	- 在 [[Android 8]].0 中，所有应用都设为使用 [[Seccomp-bpf]] 过滤器运行，该过滤器可限制允许应用使用的系统调用，从而增强应用/内核边界的安全性。
	- 在 [[Android 9]] 中，targetSdkVersion >= 28 的所有非特权应用都必须在不同的 SELinux 沙盒中运行，并针对各个应用提供 MAC。这种保护机制可以提升应用隔离效果，防止替换安全默认设置，并且（最重要的是）防止应用的数据可让所有人访问。
	- 在 [[Android 10]] 中，应用的文件系统的原始视图有限，且无法直接访问 /sdcard/[[DCIM]] 之类的路径。不过，应用保留对任何适用方法（例如 `Context.getExternalFilesDir()`）返回的软件包专用路径的完整原始访问权限。
- **文件共享指南**
	- 将应用数据设为可供所有人访问存在安全风险，这会为所有人授予访问权限，并且无法限定只让目标受众访问这些数据。这种做法会导致信息披露泄露，让代理漏洞变得混乱，并会成为针对包含敏感数据的应用（例如电子邮件客户端）的恶意软件的首选目标。在 [[Android 9]] 及更高版本中，明确禁止 targetSdkVersion>=28 的应用以这种方式共享文件。
	- 在共享文件时，请遵循以下指南：
	- 如果您的应用需要与其他应用共享文件，请使用内容提供程序([[ContentProvider]])。内容提供程序会以适当的粒度共享数据，并且不会出现使用所有人都可访问的 UNIX 权限会带来的诸多问题（如需了解详情，请参阅[内容提供程序基础知识](https://developer.android.google.cn/guide/topics/providers/content-provider-basics.html)）。
	- 如果您的应用包含确实应让所有人访问的文件（例如照片），相应文件必须是媒体文件（仅限照片、视频和音频文件）且使用 [[MediaStore]] 类存储。（如需详细了解如何添加媒体内容，请参阅访问共享存储空间中的媒体文件）。
	  存储运行时权限控制着通过 MediaStore 对强类型媒体集合的访问权限。如需访问弱类型文件（例如 PDF）和 MediaStore.Downloads 类，应用必须使用 ACTION_OPEN_DOCUMENT 等 intent。
	- 如需实现 [[Android 10]] 行为，请使用 [[requestLegacyExternalStorage]] 清单属性，并遵循应用权限最佳做法。
	- 对于以 [[Android 9]]（及更低版本）为目标平台的应用，清单标记的默认值为 true。
	  对于以 Android 10 为目标平台的应用，默认值为 false。如需在以 Android 10 为目标平台的应用中暂时退出已过滤的存储空间视图，请将清单标记的值设置为 true。
	  使用受限权限，安装程序会将允许使用未进行沙盒化的存储的应用加入白名单。未加入白名单的应用会被沙盒化。
- Ref: https://source.android.google.cn/security/app-sandbox