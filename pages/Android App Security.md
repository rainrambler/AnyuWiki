- Android 提供了一个适用于移动设备的开放源代码平台和应用环境。核心操作系统基于 Linux 内核。Android 应用通常都是使用 Java 编程语言编写的，并在 [[Dalvik]] 虚拟机中运行。不过，也可以使用原生代码编写应用。应用是通过文件扩展名为 .apk 的单个文件安装的。
- Android 应用的主要构造模块包括：
	- AndroidManifest.xml：[[AndroidManifest]].xml 文件是一个控制文件，用于告诉系统如何处理应用中的所有顶层组件（具体来说就是下面介绍的 Activity、服务、广播接收器和内容提供程序）。该文件还用于指定需要哪些权限。
	- Activity：Activity 通常是指面向用户的单个任务的代码，通常包括向用户显示界面，但也并非一定如此，有些 Activity 就从不显示界面。通常情况下，应用的入口点是应用的其中一个 Activity。
	- 服务：Service 是指在后台运行的一段代码。服务可以在自己的进程中运行，也可以在其他应用的进程中运行。其他组件会“绑定”到某项服务，并通过远程过程调用来调用该服务的方法。比如媒体播放器就是一项服务：即使用户退出媒体选择界面，大概也仍然希望音乐继续播放。即使界面已关闭，服务也可使音乐继续播放。
	- 广播接收器：[[BroadcastReceiver]]是一种对象，该对象会在操作系统或其他应用发出称为 Intent 的 IPC 机制时实例化。例如，应用可以注册一个接收器来接收电量不足的消息，并可以根据该信息改变自己的行为。
-
- **Android 权限模型** —— 受保护的API
- Android 上的所有应用均在应用沙盒([[App sandbox]])内运行。默认情况下，Android 应用只能访问有限的系统资源。系统负责管理 Android 应用对资源的访问权限。如果资源使用不当或被恶意使用，可能会给**用户体验**、**网络**或设备上的**数据**带来不利影响。
- 有三种限制方式：
	- 不支持相应API。如没有操作[[SIM]]卡的API。
	- 角色分离加上每应用独立存储。
	- 使用权限防护（Permission）
- 部分权限，如发送[[SMS]]广播Intent, 第三方App无法使用。以  signatureOrSystem permission 限制。
- **进程间通信(IPC)**
- 传统 Linux 进程间通信的机制仍然有效：文件系统、local sockets, Signals.
- 新的通信机制有：
	- [[Binder]]: 轻量级，基于capability的远程过程调用机制。使用定制的Linux驱动实现。
	- Services
	- [[Intent]]s
	- [[ContentProvider]]
- 虽然可以使用其他机制（例如Network sockets或全局可写文件）实现IPC，但这些是推荐的Android IPC框架。 将鼓励Android开发人员使用确保用户数据并避免引入安全漏洞的最佳实践。
- 成本敏感API
- 指对用户或者网络造成成本的功能。
	- 电话([[Telephony]])
	- [[SMS]], [[MMS]]
	- 上网或数据
	- App内账单
	- NFC访问
- **SIM卡访问**
	- Android 封装了SIM卡的访问，App无法使用。包括SIM卡上的通信录。也无法使用AT命令，该系列命令由 [[RIL]] (Radio Interface Layer) 处理。
- **个人信息**
	- 安卓系统已将提供访问用户数据的API置于受保护的API集合中。随着正常使用，安卓设备也会在用户安装的第三方应用程序内积累用户数据。选择分享这些信息的应用程序可以使用安卓操作系统的权限检查来保护数据不被第三方应用程序获取。
	- ![android permission](../assets/permissions_check.png)
- 权限检查保护三类信息：
	- 个人信息
	- 敏感输入设备
	- 设备元数据
- **敏感数据输入设备**
	- Android 设备经常提供敏感数据输入设备，允许应用程序与周围环境交互，例如摄像头、麦克风或 GPS。对于访问这些设备的第三方应用程序，必须首先由用户通过使用 Android 操作系统权限明确提供访问权限。安装后，安装程序将提示用户按名称请求传感器的权限。
	- 如果应用程序想知道用户的位置，则应用程序需要访问用户位置的权限。安装后，安装程序会提示用户询问应用程序是否可以访问用户的位置。在任何时候，如果用户不希望任何应用程序访问他们的位置，那么用户可以运行“设置”应用程序，进入“位置和安全”，取消选中“使用无线网络”和“启用 GPS 卫星”。这将为用户设备上的所有应用程序禁用基于位置的服务。
- **设备元数据**
	- Android 还努力限制对本质上不敏感但可能间接揭示用户特征、用户偏好以及他们使用设备的方式的数据的访问。
	- 默认情况下，应用程序无权访问**操作系统日志、浏览器历史记录、电话号码或硬件/网络标识信息**。如果应用程序在安装时请求访问此信息，安装程序将提示用户询问该应用程序是否可以访问该信息。如果用户不授予访问权限，则不会安装应用程序。
- **证书颁发机构([[CA]])**
- Android 包括一组已安装的系统证书颁发机构，它们在系统范围内是受信任的。在 Android 7.0 之前，设备制造商可以修改其设备上随附的 CA 集。但是，运行 7.0 及更高版本的设备将拥有一组统一的系统 CA，因为不再允许设备制造商进行修改。
- 要作为新的公共 CA 添加到 Android 库存集中，CA 必须完成 Mozilla CA 包含流程，然后针对 Android 提交功能请求 (https://code.google.com/p/android/issues/entry)将 CA 添加到 Android 开源项目 (AOSP) 中的库存 Android CA 集中。
- 仍有一些 CA 是特定于设备的，不应包含在 AOSP CA 的核心集中，例如运营商的私有 CA，可能需要这些 CA 来安全地访问运营商基础设施的组件，例如 SMS/MMS 网关。鼓励设备制造商仅在需要信任这些 CA 的组件/应用程序中包含私有 CA。有关详细信息，请参阅[网络安全配置](https://developer.android.google.cn/training/articles/security-config)。
-
- Prev: [[Android System and kernel security]]
- Next: [[Android Implementing Security]]