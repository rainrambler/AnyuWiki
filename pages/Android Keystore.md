- 借助系统芯片 (SoC) 中提供的可信执行环境，Android 设备可以为 Android 操作系统、平台服务乃至第三方应用提供由硬件支持的强大安全服务。
- 在 Android 6.0 之前的版本中，Android 已有一个非常简单的由硬件支持的加密服务 API（由 0.2 和 0.3 版的 Keymaster 硬件抽象层 ([[HAL]]) 提供）。该密钥库能够提供数字签名和验证操作，以及不对称签名密钥对的生成和导入操作。该 API 在许多设备上都已实现，但有许多安全目标无法只通过一个签名 API 来轻松达成。Android 6.0 中的密钥库在该密钥库 API 的基础上进行了扩展，能够提供更广泛的功能。
- 在 Android 6.0 中，密钥库不仅增加了对称加密基元([[symmetric cryptographic primitives]])（[[AES]]和[[HMAC]]），还增加了针对由硬件支持的密钥的访问控制系统。访问控制在密钥生成期间指定，并会在密钥的整个生命周期内被强制执行。可以将密钥限定为仅在用户通过身份验证后才可使用，并且只能用于指定的目的或只有在具有指定的加密参数时才可使用。如需了解详情，请参阅授权标记([[Authorization Tags]])和函数([[Keymaster Functions]])页面。
- 除了扩大加密基元的范围外，Android 6.0 中的 Keystore 还增加了以下内容：
	- 一个使用控制方案，用于限制密钥的使用，并降低因滥用密钥而损害安全性的风险
	- 一个访问控制方案，用于限定只有指定的用户和客户端能够使用相应密钥，并且只能在规定的时间范围内使用
- 在 Android 7.0 中，Keymaster 2 增加了对密钥认证和版本绑定的支持。**密钥认证**([[Key attestation]])提供公钥证书，这些证书中包含密钥及其访问控制的详细描述，以使密钥存在于安全硬件中并使其配置可以远程验证。
- **版本绑定**([[Version binding]])将密钥绑定至操作系统和补丁程序级别版本。这样可确保在旧版系统或 TEE 软件中发现漏洞的攻击者无法将设备回滚到易受攻击的版本，也无法使用在较新版本中创建的密钥。
- 在 Android 8.0 中，Keymaster 3 从旧式 C 结构硬件抽象层 (HAL) 转换到根据新硬件接口定义语言 ([[HIDL]]) 中的定义生成的 C++ HAL 接口。如需了解详情，请参阅函数([[Keymaster Functions]])页面。
- 除了此接口修订之外，Android 8.0 还扩展了 Keymaster 2 的认证功能，以支持 ID 认证([[ID-attestation]])。ID 认证提供了一种受限且可选的机制来严格认证硬件标识符，例如设备序列号、产品名称和手机 ID (IMEI/MEID)。为了实现此附加功能，需更改 ASN.1 认证架构以添加 ID 认证。Keymaster 实现需要通过某种安全方式来检索相关的数据项，还需要定义一种安全永久地停用该功能的机制。
- 在 Android 9 中，更新包括：
	- 更新到 Keymaster 4
	- 对嵌入式安全元件的支持
	- 对安全密钥导入的支持
	- 对 3DES 加密的支持
	- 更改了版本绑定，以便 boot.img 和 system.img 分别设置版本以允许独立更新
- Ref: https://source.android.google.cn/security/keystore